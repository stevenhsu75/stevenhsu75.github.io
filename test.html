<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AR換眼鏡 Demo</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
        }
        #ar-container {
            width: 100%;
            height: 100vh;
            position: absolute;
            top: 0;
            left: 0;
        }
        #start-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            font-size: 16px;
            cursor: pointer;
        }
        #start-btn:hover {
            background-color: #0056b3;
        }
    </style>
    <!-- A-Frame 在頭部加載 -->
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
</head>
<body>
    <button id="start-btn">啟動 AR</button>
    <div id="ar-container"></div>

    <script>
        // 確認 WebXR 是否可用
        if (navigator.xr) {
            console.log("WebXR is supported!");
        } else {
            alert("WebXR not supported by this browser.");
        }

        // 當用戶點擊按鈕時啟動 AR 會話
        document.getElementById('start-btn').addEventListener('click', function () {
            startAR();
        });

        function startAR() {
            // A-Frame場景設置
            const scene = document.createElement('a-scene');
            scene.setAttribute('embedded', '');
            scene.setAttribute('arjs', 'sourceType: webcam;');
            document.getElementById('ar-container').appendChild(scene);

            // 在 A-Frame 中創建眼鏡模型（這裡使用 A-Frame 的基本圖形）
            const glassesEntity = document.createElement('a-box');
            glassesEntity.setAttribute('color', '#0000ff');
            glassesEntity.setAttribute('position', '0 1 -3'); // 設置眼鏡的位置
            glassesEntity.setAttribute('scale', '0.5 0.2 0.05'); // 設置眼鏡的大小
            scene.appendChild(glassesEntity);

            // 啟動 WebXR 會話
            navigator.xr.requestSession('immersive-ar').then((session) => {
                const referenceSpace = session.requestReferenceSpace('local');
                session.addEventListener('select', onSelect);

                function onSelect(event) {
                    // 用戶觸發的事件，例如換眼鏡
                    glassesEntity.setAttribute('color', '#ff0000'); // 改變顏色
                }
            });
        }
    </script>
</body>
</html>
